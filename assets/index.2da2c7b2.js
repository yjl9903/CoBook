var _e=Object.defineProperty;var q=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var K=(t,e,n)=>e in t?_e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,J=(t,e)=>{for(var n in e||(e={}))ge.call(e,n)&&K(t,n,e[n]);if(q)for(var n of q(e))he.call(e,n)&&K(t,n,e[n]);return t};import{v as ye,a as we,d as M,b as C,u as be,c as ke,r as h,e as I,f as y,o as f,g as x,h as l,i as k,w as i,j as d,t as E,k as u,I as xe,P as Ee,N as $e,l as oe,F as $,p as Ce,m as De,n as Fe,q as B,C as Se,s as Ve,x as ae,y as Le,A as G,z as T,B as Be,D as j,E as Pe,G as Oe,H as se,J as P,K as H,L as Re,M as Te,O as U,T as Ie,Q as re,R as Ae,S as je,U as Q,V as He,W as Ue,X as Ne,Y as Me,Z as le,_ as Ge,$ as ze,a0 as We,a1 as qe,a2 as Ke}from"./vendor.16734cdb.js";const Je=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}};Je();function Qe(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:a,onRegisterError:s}=t;let c;const g=async(r=!0)=>{};return"serviceWorker"in navigator&&(c=new ye("/sw.js",{scope:"/",type:"classic"}),c.addEventListener("activated",r=>{r.isUpdate?window.location.reload():o==null||o()}),c.register({immediate:e}).then(r=>{a==null||a(r)}).catch(r=>{s==null||s(r)})),g}const N="Coin Book",ue="https://cobook-worker.yjl9903.workers.dev",Xe=[{name:"Breakfast",icon:"/img/breakfast.svg",category:"Food",tags:["Breakfast"]},{name:"Lunch",icon:"/img/lunch.svg",category:"Food",tags:["Lunch"]},{name:"Dinner",icon:"/img/dinner.svg",category:"Food",tags:["Dinner"]},{name:"Tea",icon:"/img/tea.svg",category:"Drink",tags:["Tea"],amount:10},{name:"Moon",icon:"/img/Intertwined.png",category:"Game",tags:["Genshin Impact"],amount:30}],ie=[{name:"Breakfast",color:"#fde047"},{name:"Lunch",color:"#7dd3fc"},{name:"Dinner",color:"#a5b4fc"},{name:"Genshin Impact",color:"#c4b5fd"},{name:"Tea",color:"#5eead4"}],O=[{name:"Food",color:"#86efac"},{name:"Drink",color:"#bef264"},{name:"Game",color:"#5eead4"}];var Ye=Object.defineProperty,Ze=Object.defineProperties,et=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,tt=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable,Y=(t,e,n)=>e in t?Ye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z=(t,e)=>{for(var n in e||(e={}))tt.call(e,n)&&Y(t,n,e[n]);if(X)for(var n of X(e))nt.call(e,n)&&Y(t,n,e[n]);return t},ee=(t,e)=>Ze(t,et(e)),V=class{constructor(t,e,n){this.errorHandler=[],this.fingerprint=n,this.api=we.create({baseURL:t,headers:{Authorization:e}})}async validate(){try{return await this.api.get("/"),!0}catch{return!1}}async create(t){const{data:e}=await this.api.post("/account",ee(Z({},t),{timestamp:new Date().toISOString(),fingerprint:this.fingerprint}));if(V.isResponseError(e))throw await this.handleError(e),e;return e}async update(t,e){const{data:n}=await this.api.put(`/account/${t}`,ee(Z({},e),{fingerprint:this.fingerprint}));if(V.isResponseError(n))throw await this.handleError(n),n;return n}async delete(t){const{data:e}=await this.api.delete(`/account/${t}`);return!V.isResponseError(e)}async list(){const{data:t}=await this.api.get("/accounts");if(V.isResponseError(t))throw await this.handleError(t),t;return t.accounts}static isResponseError(t){return!t||t.status==="ERROR"}onError(t){this.errorHandler.push(t)}async handleError(t){await Promise.all(this.errorHandler.map(e=>e(t)))}};const ot="modulepreload",te={},at="/",R=function(e,n){return!n||n.length===0?e():Promise.all(n.map(o=>{if(o=`${at}${o}`,o in te)return;te[o]=!0;const a=o.endsWith(".css"),s=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${s}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":ot,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((g,r)=>{c.addEventListener("load",g),c.addEventListener("error",r)})})).then(()=>e())};async function ce(){return await(await(await R(()=>import("./fp.esm.27f96b96.js"),[])).load()).get()}const st=ce();async function rt(){try{return await st}catch{return await ce()}}const L=M("authorization",{state:()=>({fingerprint:"",pass:""}),getters:{client:t=>new V(ue,t.pass,t.fingerprint)},persist:!0}),de=M("authorization/valid",{state:()=>({ok:!1})});async function me(){const t=de();if(t.ok)return!0;const e=L(),n=e.pass!==""&&e.fingerprint!==""&&await e.client.validate();return t.ok=n,n}async function Nt(t){const e=de(),n=L();return n.fingerprint=(await rt()).visitorId,await new V(ue,t,n.fingerprint).validate()?(e.ok=!0,n.pass=t,!0):!1}const pe="EnterHome";const lt={style:{"font-weight":"bold"}},ut=C({setup(t){const e=be(),n=ke(),o=h(!1);Ce(pe,o),me().then(r=>o.value=r);const a=I(()=>e.name==="Login"),s=h(!1),c=[{text:"\u8BB0\u5F55",icon:"home-o"},{text:"\u6240\u6709",icon:"orders-o"},{text:"\u5173\u4E8E",icon:"info-o"}],g=r=>{r.text===c[0].text?n.push({name:"Home"}):r.text===c[1].text?n.push({name:"Account"}):r.text===c[2].text&&n.push({name:"About"})};return(r,v)=>{const m=y("router-view");return f(),x($,null,[!l(a)&&o.value?(f(),k(l($e),{key:0,fixed:"",placeholder:""},{title:i(()=>[d("span",lt,E(l(N)),1)]),right:i(()=>[u(l(Ee),{show:s.value,"onUpdate:show":v[0]||(v[0]=D=>s.value=D),actions:c,onSelect:g,placement:"bottom-end","show-arrow":!1,offset:[8,12]},{reference:i(()=>[u(l(xe),{name:"ellipsis",color:"black",mr:"1"})]),_:1},8,["show"])]),_:1})):oe("",!0),u(m,{id:"main-view",h:"full"})],64)}}});const z=M("account",{state(){return{accounts:[]}},actions:{async init(){const e=await L().client.list();this.accounts=e},async push(t){const n=await L().client.create({amount:t.amount,category:t.category,tags:t.tags,description:t.description});this.accounts.push(n)},async update(t,e){const o=await L().client.update(t,e),a=this.accounts.findIndex(s=>s.timestamp===t);return a!==-1&&(this.accounts.splice(a,1),this.accounts.push(o),this.accounts.sort((s,c)=>s.timestamp.localeCompare(c.timestamp))),o},async delete(t){const n=await L().client.delete(t.timestamp);if(n){const o=this.accounts.findIndex(a=>a.timestamp===t.timestamp);return o!==-1&&this.accounts.splice(o,1),n}else return!1}},persist:!0}),it={flex:"",justify:"between"},ct=d("span",null,"\u6807\u7B7E",-1),dt={px:"4",pb:"8"},mt={flex:"",items:"center"},fe=C({props:{modelValue:null},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,{modelValue:o}=De(n),a=h(!1),s=h([]);Fe(()=>{s.value=[]});const c=g=>{s.value[g].toggle()};return(g,r)=>{const v=y("Tag"),m=y("van-cell"),D=y("van-cell-group");return f(),x($,null,[u(m,{clickable:"",onClick:r[0]||(r[0]=p=>a.value=!0)},{default:i(()=>[d("div",it,[ct,d("span",null,[(f(!0),x($,null,B(l(o),p=>(f(),k(v,{ml:"1",tag:p},null,8,["tag"]))),256))])])]),_:1}),u(l(G),{show:a.value,"onUpdate:show":r[3]||(r[3]=p=>a.value=p),title:"\u6807\u7B7E",duration:.2,"overlay-style":{background:"rgba(0, 0, 0, .1)"}},{default:i(()=>[d("div",dt,[u(l(Se),{"model-value":l(o),"onUpdate:modelValue":r[2]||(r[2]=p=>e("update:modelValue",p))},{default:i(()=>[u(D,null,{default:i(()=>[(f(!0),x($,null,B(l(ie),(p,_)=>(f(),k(m,{clickable:"",key:p.name,onClick:F=>c(_)},{"right-icon":i(()=>[u(l(Ve),{name:p.name,ref_for:!0,ref:F=>s.value[_]=F,onClick:r[1]||(r[1]=ae(()=>{},["stop"])),shape:"square"},null,8,["name"])]),default:i(()=>[d("div",mt,[d("span",{h:"4",w:"4",mr:"2","inline-block":"",rounded:"full",style:Le({background:p.color})},null,4),d("span",null,E(p.name),1)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["model-value"])])]),_:1},8,["show","duration","overlay-style"])],64)}}}),pt={px:"4",pb:"8"},ne=C({props:{title:null},setup(t){const e=h(!1);return(n,o)=>{const a=y("van-cell");return f(),x($,null,[u(a,{clickable:"",onClick:o[0]||(o[0]=s=>e.value=!0)},{default:i(()=>[T(n.$slots,"cell")]),_:3}),u(l(G),{show:e.value,"onUpdate:show":o[1]||(o[1]=s=>e.value=s),title:t.title,duration:.2,"overlay-style":{background:"rgba(0, 0, 0, .1)"}},{default:i(()=>[d("div",pt,[T(n.$slots,"default",{close:()=>e.value=!1})])]),_:3},8,["show","title","duration","overlay-style"])],64)}}}),ft={px:"4",pb:"8"},vt={flex:"",justify:"between"},_t=d("span",null,"\u91D1\u989D",-1),gt={flex:"",justify:"between"},ht=d("span",null,"\u5206\u7C7B",-1),yt={flex:"",justify:"between"},wt=d("span",null,"\u65F6\u95F4",-1),bt={mt:"4",text:"right"},kt=P("\u4FDD\u5B58"),xt=P("\u5220\u9664"),Et=C({props:{account:null},emits:["close"],setup(t,{emit:e}){const n=t,o=h(n.account),a=h(!1),s=I({get(){var v,m;return((v=o.value)==null?void 0:v.timestamp)?new Date((m=o.value)==null?void 0:m.timestamp):new Date},set(v){var m;((m=o.value)==null?void 0:m.timestamp)&&(o.value.timestamp=v.toISOString())}});Be(()=>n.account,v=>{v&&(o.value=J({},v),a.value=!0)});const c=z(),g=async()=>{o.value&&(await c.update(n.account.timestamp,o.value),a.value=!1,H({message:"\u66F4\u65B0\u6210\u529F",type:"success"}))},r=async()=>{o.value&&(await c.delete(o.value),a.value=!1,H({message:"\u5220\u9664\u6210\u529F",type:"success"}))};return(v,m)=>{const D=y("Category"),p=y("van-cell"),_=y("van-cell-group"),F=y("van-button");return f(),k(l(G),{show:a.value,"onUpdate:show":m[5]||(m[5]=b=>a.value=b),title:t.account&&l(j)(new Date(t.account.timestamp),"yyyy-MM-dd HH:mm"),duration:.2,"overlay-style":{background:"rgba(0, 0, 0, .1)"},onClose:m[6]||(m[6]=b=>e("close"))},{default:i(()=>[d("div",ft,[o.value?(f(),k(_,{key:0},{default:i(()=>[u(ne,{title:"\u91D1\u989D"},{cell:i(()=>[d("div",vt,[_t,d("span",null,"\uFFE5 "+E(o.value.amount),1)])]),_:1}),u(p,null,{default:i(()=>[d("div",gt,[ht,u(D,{category:o.value.category},null,8,["category"])])]),_:1}),u(fe,{modelValue:o.value.tags,"onUpdate:modelValue":m[0]||(m[0]=b=>o.value.tags=b)},null,8,["modelValue"]),u(ne,{title:"\u65F6\u95F4"},{cell:i(()=>[d("div",yt,[wt,d("span",null,E(l(j)(new Date(o.value.timestamp),"yyyy-MM-dd HH:mm:ss")),1)])]),default:i(({close:b})=>[u(l(Pe),{modelValue:l(s),"onUpdate:modelValue":m[1]||(m[1]=A=>Oe(s)?s.value=A:null),type:"datetime","max-date":new Date(new Date().getTime()+3600*1e3),onConfirm:b,onCancel:()=>(s.value=new Date(t.account.timestamp),b())},null,8,["modelValue","max-date","onConfirm","onCancel"])]),_:1}),u(l(se),{modelValue:o.value.description,"onUpdate:modelValue":m[2]||(m[2]=b=>o.value.description=b),rows:"2",autosize:"",label:"\u5907\u6CE8",type:"textarea",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})):oe("",!0),d("div",bt,[u(F,{round:"",icon:"guide-o",type:"success",mr:"4",onClick:m[3]||(m[3]=b=>g())},{default:i(()=>[kt]),_:1}),u(F,{round:"",icon:"delete",type:"danger",onClick:m[4]||(m[4]=b=>r())},{default:i(()=>[xt]),_:1})])])]),_:1},8,["show","title","duration","overlay-style"])}}});const $t={flex:"",justify:"between",items:"center"},Ct={"inline-block":"",mr:"2",text:"gray-400"},Dt=C({setup(t){const e=z();e.init();const n=h();return(o,a)=>{const s=y("Category"),c=y("van-cell"),g=y("van-cell-group");return f(),k(g,{inset:""},{default:i(()=>[u(l(Re),null,{default:i(()=>[(f(!0),x($,null,B(l(e).accounts.slice().reverse(),r=>(f(),k(c,{key:r.timestamp,clickable:"",onClick:v=>n.value=r},{default:i(()=>[d("div",$t,[d("span",null,[d("span",Ct,E(l(j)(new Date(r.timestamp),"yyyy-MM-dd HH:mm")),1),u(s,{category:r.category},null,8,["category"])]),d("span",null,"\uFFE5 "+E(r.amount),1)])]),_:2},1032,["onClick"]))),128))]),_:1}),u(Et,{account:n.value,onClose:a[0]||(a[0]=r=>n.value=void 0)},null,8,["account"])]),_:1})}}});const Ft={id:"home",h:"full",pt:"4"},St={flex:"",justify:"between"},Vt=d("span",null,"\u5206\u7C7B",-1),Lt={flex:"","flex-col":"",items:"center",justify:"center",class:"content-center justify-items-center"},Bt={h:"full",w:"full"},Pt={class:"van-grid-item__text",mt:"2",text:"center"},Ot={style:{margin:"16px"}},Rt=P("\u8BB0\u5F55"),Tt=C({setup(t){Te(pe).value=!0;const e=z(),n=h(),o=h(!1),a=h(),s=h(""),c=p=>(s.value="",/\d+\.\d\d\d+$/.test(p)?Number.parseFloat(p).toFixed(2):p),g=h(O.length>0?O[0].name:""),r=h([]),v=h(""),m=p=>{g.value=p.category,p.amount?a.value=String(p.amount):a.value="",p.tags?r.value=p.tags:r.value=[],p.description,v.value=""},D=async()=>{if(!a.value||a.value===""){s.value="\u8BF7\u8F93\u5165\u91D1\u989D";return}await e.push({amount:+a.value,category:g.value,tags:r.value,description:v.value}),H({message:"\u8BB0\u5F55\u6210\u529F",type:"success"}),a.value="",r.value=[],v.value=""};return(p,_)=>{const F=y("Category"),b=y("van-image"),A=y("van-button");return f(),x("div",Ft,[u(l(re),{inset:""},{default:i(()=>[u(l(se),{modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=w=>a.value=w),label:"\u91D1\u989D",readonly:"",clickable:"",clearable:"",formatter:c,maxlength:10,"error-message":s.value,"error-message-align":"right",onTouchstart:_[1]||(_[1]=ae(w=>o.value=!0,["stop"])),"input-align":"right"},null,8,["modelValue","error-message"]),u(l(U),null,{default:i(()=>[d("div",St,[Vt,u(F,{category:g.value},null,8,["category"])])]),_:1}),u(fe,{modelValue:r.value,"onUpdate:modelValue":_[2]||(_[2]=w=>r.value=w)},null,8,["modelValue"]),u(l(U),null,{default:i(()=>[u(l(Ie),{active:n.value,"onUpdate:active":_[3]||(_[3]=w=>n.value=w)},{default:i(()=>[(f(!0),x($,null,B(l(O),w=>(f(),k(l(Ue),{key:w.name,title:w.name},{default:i(()=>[u(l(je),{border:!1,clickable:""},{default:i(()=>[u(l(Q),{icon:"success",text:"\u4F7F\u7528",onClick:S=>m({category:w.name})},null,8,["onClick"]),(f(!0),x($,null,B(l(Xe).filter(S=>S.category===w.name),S=>(f(),k(l(Q),{onClick:jt=>m(S)},{default:i(()=>[d("div",Lt,[u(b,{src:S.icon,fit:"scale-down",class:"max-h-[50%] max-w-[50%]"},{loading:i(()=>[d("div",Bt,[u(l(He),{type:"spinner",size:"20"})])]),_:2},1032,["src"]),d("span",Pt,E(S.name),1)])]),_:2},1032,["onClick"]))),256))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1})]),_:1}),d("div",Ot,[u(A,{round:"",block:"",type:"success",onClick:D},{default:i(()=>[Rt]),_:1})]),u(Dt),u(l(Ae),{modelValue:a.value,"onUpdate:modelValue":_[4]||(_[4]=w=>a.value=w),"extra-key":".",show:o.value,maxlength:10,onBlur:_[5]||(_[5]=w=>o.value=!1)},null,8,["modelValue","show"])])}}}),W=Ne({history:Me(),routes:[{path:"/",name:"Home",component:Tt},{path:"/account",name:"Account",component:()=>R(()=>import("./index.89c7514d.js"),["assets/index.89c7514d.js","assets/index.97d966c7.css","assets/vendor.16734cdb.js","assets/vendor.8c17d8b4.css"])},{path:"/login",name:"Login",component:()=>R(()=>import("./Login.190e86d2.js"),["assets/Login.190e86d2.js","assets/Login.79953f6d.css","assets/vendor.16734cdb.js","assets/vendor.8c17d8b4.css"]),meta:{title:"\u767B\u9646"}},{path:"/about",name:"About",component:()=>R(()=>import("./About.405ceaf5.js"),["assets/About.405ceaf5.js","assets/About.393076f1.css","assets/vendor.16734cdb.js","assets/vendor.8c17d8b4.css"]),meta:{title:"\u5173\u4E8E"}}],scrollBehavior(t,e,n){return n||{top:0}}});W.beforeEach(async t=>t.name==="Login"||await me()?!0:{name:"Login"});W.beforeEach(t=>{t.meta.title?document.title=t.meta.title+" - "+N:document.title=N});const It=C({props:{tag:null},setup(t){const e=t,n=I(()=>{var o,a;return typeof e.tag=="string"?{name:e.tag,color:(a=(o=ie.find(s=>s.name===e.tag))==null?void 0:o.color)!=null?a:"#F2F3F5"}:e.tag});return(o,a)=>(f(),k(l(le),{color:l(n).color},{default:i(()=>[T(o.$slots,"default",{},()=>[P(E(l(n).name),1)])]),_:3},8,["color"]))}}),At=C({props:{category:null},setup(t){const e=t,n=I(()=>{var o,a;return typeof e.category=="string"?{name:e.category,color:(a=(o=O.find(s=>s.name===e.category))==null?void 0:o.color)!=null?a:"#F2F3F5"}:e.category});return(o,a)=>(f(),k(l(le),{color:l(n).color},{default:i(()=>[T(o.$slots,"default",{},()=>[P(E(l(n).name),1)])]),_:3},8,["color"]))}});Qe({});const ve=Ge();ve.use(ze);We(ut).component("Category",At).component("Tag",It).use(U).use(re).use(qe).use(Ke).use(W).use(ve).mount("#app");{document.addEventListener("gesturestart",function(e){e.preventDefault()}),document.addEventListener("dblclick",function(e){e.preventDefault()}),document.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()});let t=0;document.addEventListener("touchend",function(e){const n=new Date().getTime();n-t<=300&&e.preventDefault(),t=n},!1)}export{Dt as _,rt as f,Nt as l,N as n};
