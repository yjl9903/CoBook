import{v as ne,a as oe,d as T,b as N,r as y,c as z,o as p,e as k,u as s,f as w,w as l,N as re,g as W,h as c,F as D,i as se,j as ae,p as ie,k as E,l as u,t as h,I as ue,P as le,m as P,L as ce,T as L,n as x,q as C,s as de,A as fe,x as pe,C as G,y as me,z as _e,B as ve,D as he,E as $,G as ge,H as ye,J as I,K as we,M as be,O as ke,Q as Ee,R as xe,S as Fe,U as De,V as Le}from"./vendor.bb2c2c2b.js";const Pe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};Pe();function Be(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:a,onRegistered:o,onRegisterError:i}=e;let r;const m=async(d=!0)=>{};return"serviceWorker"in navigator&&(r=new ne("/sw.js",{scope:"/",type:"classic"}),r.addEventListener("activated",d=>{d.isUpdate?window.location.reload():a==null||a()}),r.register({immediate:t}).then(d=>{o==null||o(d)}).catch(d=>{i==null||i(d)})),m}const j="Coin Book",K="https://cobook-worker.yjl9903.workers.dev",Oe=[{name:"Breakfast",icon:"/img/breakfast.svg",category:"Food",tags:["Food","Breakfast"],amount:10},{name:"Lunch",icon:"/img/lunch.svg",category:"Food",tags:["Food","Lunch"],amount:10},{name:"Dinner",icon:"/img/dinner.svg",category:"Food",tags:["Food","Dinner"],amount:10},{name:"Tea",icon:"/img/tea.svg",category:"Drink",tags:["Drink"]}],R=[{name:"Food",color:"#F2F3F5"},{name:"Drink",color:"#F2F3F5"}];var Se=Object.defineProperty,Ce=Object.defineProperties,Re=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,$e=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,M=(e,t,n)=>t in e?Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ve=(e,t)=>{for(var n in t||(t={}))$e.call(t,n)&&M(e,n,t[n]);if(H)for(var n of H(t))je.call(t,n)&&M(e,n,t[n]);return e},Te=(e,t)=>Ce(e,Re(t)),B=class{constructor(e,t,n){this.errorHandler=[],this.fingerprint=n,this.api=oe.create({baseURL:e,headers:{Authorization:t}})}async validate(){try{return await this.api.get("/"),!0}catch{return!1}}async create(e){const{data:t}=await this.api.post("/account",Te(Ve({},e),{fingerprint:this.fingerprint,timestamp:new Date().getTime()}));if(B.isResponseError(t))throw await this.handleError(t),t;return t}async list(){const{data:e}=await this.api.get("/accounts");if(B.isResponseError(e))throw await this.handleError(e),e;return e.accounts}static isResponseError(e){return!e||e.status==="ERROR"}onError(e){this.errorHandler.push(e)}async handleError(e){await Promise.all(this.errorHandler.map(t=>t(e)))}};const Ne="modulepreload",U={},Ae="/",V=function(t,n){return!n||n.length===0?t():Promise.all(n.map(a=>{if(a=`${Ae}${a}`,a in U)return;U[a]=!0;const o=a.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${i}`))return;const r=document.createElement("link");if(r.rel=o?"stylesheet":Ne,o||(r.as="script",r.crossOrigin=""),r.href=a,document.head.appendChild(r),o)return new Promise((m,d)=>{r.addEventListener("load",m),r.addEventListener("error",d)})})).then(()=>t())};async function q(){return await(await(await V(()=>import("./fp.esm.27f96b96.js"),[])).load()).get()}const Ie=q();async function He(){try{return await Ie}catch{return await q()}}const O=T("authorization",{state:()=>({fingerprint:"",pass:""}),getters:{client:e=>new B(K,e.pass,e.fingerprint)},persist:!0}),J=T("authorization/valid",{state:()=>({ok:!1})});async function Q(){const e=J();if(e.ok)return!0;const t=O(),n=t.pass!==""&&t.fingerprint!==""&&await t.client.validate();return e.ok=n,n}async function vt(e){const t=J(),n=O();return n.fingerprint=(await He()).visitorId,await new B(K,e,n.fingerprint).validate()?(t.ok=!0,n.pass=e,!0):!1}const X="EnterHome";const Me={style:{"font-weight":"bold"}},Ue=N({setup(e){const t=se(),n=ae(),a=y(!1);ie(X,a),Q().then(d=>a.value=d);const o=z(()=>t.name==="Login"),i=y(!1),r=[{text:"\u8BB0\u5F55",icon:"home-o"},{text:"\u5173\u4E8E",icon:"info-o"}],m=d=>{d.text===r[0].text?n.push({name:"Home"}):d.text===r[1].text&&n.push({name:"About"})};return(d,f)=>{const F=E("router-view");return p(),k(D,null,[!s(o)&&a.value?(p(),w(s(re),{key:0,fixed:"",placeholder:""},{title:l(()=>[u("span",Me,h(s(j)),1)]),right:l(()=>[c(s(le),{show:i.value,"onUpdate:show":f[0]||(f[0]=S=>i.value=S),actions:r,onSelect:m,placement:"bottom-end","show-arrow":!1,offset:[8,12]},{reference:l(()=>[c(s(ue),{name:"ellipsis",color:"black",mr:"1"})]),_:1},8,["show"])]),_:1})):W("",!0),c(F,{id:"main-view",h:"full"})],64)}}}),Y=T("account",{state(){return{accounts:[]}},actions:{async init(){const t=await O().client.list();this.accounts=t},async push(e){const n=await O().client.create({amount:e.amount,category:e.category,tags:e.tags,description:e.description});this.accounts.push(n)}},persist:!0});const ze={flex:"",justify:"between",items:"center"},We={"inline-block":"",mr:"2",text:"gray-400"},Ge={px:"4",pb:"8"},Ke={flex:"",justify:"between"},qe=u("span",null,"\u91D1\u989D",-1),Je={flex:"",justify:"between"},Qe=u("span",null,"\u5206\u7C7B",-1),Xe={flex:"",justify:"between"},Ye=u("span",null,"\u6807\u7B7E",-1),Ze={flex:"",justify:"between"},et=u("span",null,"\u65F6\u95F4",-1),tt={flex:"",justify:"between"},nt=u("span",null,"\u5907\u6CE8",-1),ot={mt:"4",text:"right"},rt=x("\u5220\u9664"),st=N({setup(e){const t=Y();t.init();const n=y(),a=z({get(){return!!n.value},set(){n.value=void 0}});return(o,i)=>{const r=E("van-cell"),m=E("van-cell-group"),d=E("van-button");return p(),w(m,{inset:""},{default:l(()=>[c(s(ce),null,{default:l(()=>[(p(!0),k(D,null,P(s(t).accounts.slice().reverse(),f=>(p(),w(r,{key:f.timestamp,clickable:"",onClick:F=>n.value=f},{default:l(()=>[u("div",ze,[u("span",null,[u("span",We,h(s(C)(new Date(f.timestamp),"yyyy-MM-dd hh:mm")),1),c(s(L),null,{default:l(()=>[x(h(f.category),1)]),_:2},1024)]),u("span",null,"\uFFE5 "+h(f.amount),1)])]),_:2},1032,["onClick"]))),128))]),_:1}),c(s(fe),{show:s(a),"onUpdate:show":i[0]||(i[0]=f=>de(a)?a.value=f:null),title:n.value&&s(C)(new Date(n.value.timestamp),"yyyy-MM-dd hh:mm"),duration:.2,"overlay-style":{background:"transparent"}},{default:l(()=>[u("div",Ge,[n.value?(p(),w(m,{key:0},{default:l(()=>[c(r,null,{default:l(()=>[u("div",Ke,[qe,u("span",null,"\uFFE5 "+h(n.value.amount),1)])]),_:1}),c(r,null,{default:l(()=>[u("div",Je,[Qe,c(s(L),null,{default:l(()=>[x(h(n.value.category),1)]),_:1})])]),_:1}),c(r,null,{default:l(()=>[u("div",Xe,[Ye,u("span",null,[(p(!0),k(D,null,P(n.value.tags,f=>(p(),w(s(L),{ml:"1"},{default:l(()=>[x(h(f),1)]),_:2},1024))),256))])])]),_:1}),c(r,null,{default:l(()=>[u("div",Ze,[et,u("span",null,h(s(C)(new Date(n.value.timestamp),"yyyy-MM-dd hh:mm")),1)])]),_:1}),c(r,null,{default:l(()=>[u("div",tt,[nt,u("span",null,h(n.value.description),1)])]),_:1})]),_:1})):W("",!0),u("div",ot,[c(d,{round:"",icon:"delete",type:"danger"},{default:l(()=>[rt]),_:1})])])]),_:1},8,["show","title","duration"])]),_:1})}}});const at={id:"home",h:"full",pt:"4"},it={flex:"",justify:"between"},ut=u("span",null,"\u5206\u7C7B",-1),lt={flex:"","flex-col":"",items:"center",justify:"center"},ct={class:"van-grid-item__text mt-2"},dt={style:{margin:"16px"}},ft=x("\u8BB0\u5F55"),pt=N({setup(e){pe(X).value=!0;const t=Y(),n=y(),a=y(!1),o=y(),i=y(""),r=v=>(i.value="",/\d+\.\d\d\d+$/.test(v)?Number.parseFloat(v).toFixed(2):v),m=y(R.length>0?R[0].name:""),d=y([]),f=y(""),F=v=>{m.value=v.category,v.amount&&(o.value=v.amount),v.tags&&(d.value=v.tags),v.description&&(f.value="")},S=async()=>{if(!o.value||o.value===""){i.value="\u8BF7\u8F93\u5165\u91D1\u989D";return}await t.push({amount:+o.value,category:m.value,tags:d.value,description:f.value}),_e({message:"\u8BB0\u5F55\u6210\u529F",type:"success"}),o.value="",d.value=[],f.value=""};return(v,g)=>{const ee=E("van-image"),te=E("van-button");return p(),k("div",at,[c(s(G),{inset:""},{default:l(()=>[c(s(ve),{modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=_=>o.value=_),label:"\u91D1\u989D",readonly:"",clickable:"",clearable:"",formatter:r,maxlength:10,"error-message":i.value,"error-message-align":"right",onTouchstart:g[1]||(g[1]=he(_=>a.value=!0,["stop"])),"input-align":"right"},null,8,["modelValue","error-message"]),c(s($),null,{default:l(()=>[u("div",it,[ut,c(s(L),null,{default:l(()=>[x(h(m.value),1)]),_:1})])]),_:1}),c(s($),null,{default:l(()=>[c(s(ge),{active:n.value,"onUpdate:active":g[2]||(g[2]=_=>n.value=_)},{default:l(()=>[(p(!0),k(D,null,P(s(R),_=>(p(),w(s(we),{key:_.name,title:_.name},{default:l(()=>[c(s(ye),{border:!1,clickable:""},{default:l(()=>[c(s(I),{icon:"success",text:"\u4F7F\u7528",onClick:b=>F({category:_.name})},null,8,["onClick"]),(p(!0),k(D,null,P(s(Oe).filter(b=>b.category===_.name),b=>(p(),w(s(I),{onClick:mt=>F(b)},{default:l(()=>[u("div",lt,[c(ee,{src:b.icon,height:"50%",width:"50%"},null,8,["src"]),u("span",ct,h(b.name),1)])]),_:2},1032,["onClick"]))),256))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1})]),_:1}),u("div",dt,[c(te,{round:"",block:"",type:"success",onClick:S},{default:l(()=>[ft]),_:1})]),c(st),c(s(me),{modelValue:o.value,"onUpdate:modelValue":g[3]||(g[3]=_=>o.value=_),"extra-key":".",show:a.value,maxlength:10,onBlur:g[4]||(g[4]=_=>a.value=!1)},null,8,["modelValue","show"])])}}}),A=be({history:ke(),routes:[{path:"/",name:"Home",component:pt},{path:"/login",name:"Login",component:()=>V(()=>import("./Login.63f1eec1.js"),["assets/Login.63f1eec1.js","assets/Login.79953f6d.css","assets/vendor.bb2c2c2b.js","assets/vendor.f72989cf.css"]),meta:{title:"\u767B\u9646"}},{path:"/about",name:"About",component:()=>V(()=>import("./About.74b863a7.js"),["assets/About.74b863a7.js","assets/About.1be23510.css","assets/vendor.bb2c2c2b.js","assets/vendor.f72989cf.css"]),meta:{title:"\u5173\u4E8E"}}],scrollBehavior(e,t,n){return n||{top:0}}});A.beforeEach(async e=>e.name==="Login"||await Q()?!0:{name:"Login"});A.beforeEach(e=>{e.meta.title?document.title=e.meta.title+" - "+j:document.title=j});Be({});const Z=Ee();Z.use(xe);Fe(Ue).use($).use(G).use(De).use(Le).use(A).use(Z).mount("#app");{document.addEventListener("gesturestart",function(t){t.preventDefault()}),document.addEventListener("dblclick",function(t){t.preventDefault()}),document.addEventListener("touchstart",function(t){t.touches.length>1&&t.preventDefault()});let e=0;document.addEventListener("touchend",function(t){const n=new Date().getTime();n-e<=300&&t.preventDefault(),e=n},!1)}export{vt as l,j as n};
