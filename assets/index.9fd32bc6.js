import{v as M,d as D,r as v,c as q,a as _,u as a,b as y,w as u,N as J,e as Q,f as l,P as X,F as k,g as Y,p as Z,h as b,o as f,I as S,i as m,t as g,j as ee,k as $,l as P,m as te,T as j,n as B,L as ne,C as A,q as re,s as oe,x as se,y as ae,z as ie,A as O,B as le,G as ue,D as R,E as ce,H as de,J as pe,K as fe,M as me,O as he,Q as ve}from"./vendor.a347c1fa.js";const _e=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};_e();function ge(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisterError:s}=e;let o;const h=async(c=!0)=>{};return"serviceWorker"in navigator&&(o=new M("/sw.js",{scope:"/",type:"classic"}),o.addEventListener("activated",c=>{c.isUpdate?window.location.reload():i==null||i()}),o.register({immediate:t}).then(c=>{r==null||r(c)}).catch(c=>{s==null||s(c)})),h}const x="Coin Book",H="https://cobook-worker.yjl9903.workers.dev",ye=[{name:"Breakfast",icon:"/img/breakfast.svg",category:"Food",tags:["Food","Breakfast"],amount:10},{name:"Lunch",icon:"/img/lunch.svg",category:"Food",tags:["Food","Lunch"],amount:10},{name:"Dinner",icon:"/img/dinner.svg",category:"Food",tags:["Food","Dinner"],amount:10},{name:"Tea",icon:"/img/tea.svg",category:"Drink",tags:["Drink"]}],L=[{name:"Food",color:"#F2F3F5"},{name:"Drink",color:"#F2F3F5"}],I="EnterHome";const we={style:{"font-weight":"bold"}},ke=D({setup(e){const t=Y(),n=v(!1);Z(I,n);const i=q(()=>t.name==="Login"),r=v(!1);return(s,o)=>{const h=b("router-view");return f(),_(k,null,[!a(i)&&n.value?(f(),y(a(J),{key:0,fixed:"",placeholder:""},{left:u(()=>[l(a(S),{name:"ellipsis",color:"black",onClick:o[0]||(o[0]=c=>r.value=!0)})]),title:u(()=>[m("span",we,g(a(x)),1)]),right:u(()=>[l(a(S),{name:"setting-o",color:"black"})]),_:1})):Q("",!0),l(a(X),{show:r.value,"onUpdate:show":o[1]||(o[1]=c=>r.value=c),position:"left",style:{height:"100%",width:"60%"}},null,8,["show"]),l(h)],64)}}}),be="modulepreload",N={},Ee="/",U=function(t,n){return!n||n.length===0?t():Promise.all(n.map(i=>{if(i=`${Ee}${i}`,i in N)return;N[i]=!0;const r=i.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${s}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":be,r||(o.as="script",o.crossOrigin=""),o.href=i,document.head.appendChild(o),r)return new Promise((h,c)=>{o.addEventListener("load",h),o.addEventListener("error",c)})})).then(()=>t())};var Fe=Object.defineProperty,Le=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,Oe=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,V=(e,t,n)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,De=(e,t)=>{for(var n in t||(t={}))Oe.call(t,n)&&V(e,n,t[n]);if(T)for(var n of T(t))xe.call(t,n)&&V(e,n,t[n]);return e},Be=(e,t)=>Le(e,Pe(t)),E=class{constructor(e,t,n){this.errorHandler=[],this.fingerprint=n,this.api=ee.create({baseURL:e,headers:{Authorization:t}})}async validate(){try{return await this.api.get("/"),!0}catch{return!1}}async create(e){const{data:t}=await this.api.post("/account",Be(De({},e),{fingerprint:this.fingerprint,timestamp:new Date().getTime()}));if(E.isResponseError(t))throw await this.handleError(t),t;return t}async list(){const{data:e}=await this.api.get("/accounts");if(E.isResponseError(e))throw await this.handleError(e),e;return e.accounts}static isResponseError(e){return!e||e.status==="ERROR"}onError(e){this.errorHandler.push(e)}async handleError(e){await Promise.all(this.errorHandler.map(t=>t(e)))}};async function W(){return await(await(await U(()=>import("./fp.esm.27f96b96.js"),[])).load()).get()}const Ce=W();async function Se(){try{return await Ce}catch{return await W()}}const F=$("authorization",{state:()=>({fingerprint:"",pass:""}),getters:{client:e=>new E(H,e.pass,e.fingerprint)},persist:!0});async function Re(){const e=F();return e.pass!==""&&e.fingerprint!==""&&await e.client.validate()}async function ze(e){const t=F();return t.fingerprint=(await Se()).visitorId,await new E(H,e,t.fingerprint).validate()?(t.pass=e,!0):!1}const z=$("account",{state(){return{accounts:[]}},actions:{async init(){const t=await F().client.list();this.accounts=t},async push(e){const n=await F().client.create({amount:e.amount,category:e.category,tags:e.tags,description:e.description});this.accounts.push(n)}},persist:!0}),Ne={flex:"",justify:"between",items:"center"},Te={"inline-block":"",mr:"2",text:"gray-400"},Ve=D({setup(e){const t=z();return t.init(),(n,i)=>{const r=b("van-cell"),s=b("van-cell-group");return f(),y(s,{inset:""},{default:u(()=>[l(a(ne),null,{default:u(()=>[(f(!0),_(k,null,P(a(t).accounts.slice().reverse(),o=>(f(),y(r,{key:o.timestamp},{default:u(()=>[m("div",Ne,[m("span",null,[m("span",Te,g(a(te)(new Date(o.timestamp),"yyyy-MM-dd hh:mm")),1),l(a(j),null,{default:u(()=>[B(g(o.category),1)]),_:2},1024)]),m("span",null,"\uFFE5 "+g(o.amount),1)])]),_:2},1024))),128))]),_:1})]),_:1})}}});const $e={id:"home",h:"full",pt:"4"},je={flex:"",justify:"between"},Ae=m("span",null,"\u5206\u7C7B",-1),He={style:{margin:"16px"}},Ie=B("\u8BB0\u5F55"),Ue=D({setup(e){const t=oe(I);t.value=!0;const n=z(),i=v(),r=v(!1),s=v(""),o=v(L.length>0?L[0].name:""),h=async()=>{await n.push({amount:+s.value,category:o.value,tags:[],description:""}),se({message:"\u8BB0\u5F55\u6210\u529F",type:"success"}),s.value=""};return(c,p)=>{const K=b("van-button");return f(),_("div",$e,[l(a(A),{inset:""},{default:u(()=>[l(a(ae),{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=d=>s.value=d),label:"\u91D1\u989D",readonly:"",clickable:"",placeholder:"\uFFE5 0",onTouchstart:p[1]||(p[1]=ie(d=>r.value=!0,["stop"])),"input-align":"right"},null,8,["modelValue"]),l(a(O),null,{default:u(()=>[m("div",je,[Ae,l(a(j),null,{default:u(()=>[B(g(o.value),1)]),_:1})])]),_:1}),l(a(O),null,{default:u(()=>[l(a(le),{active:i.value,"onUpdate:active":p[2]||(p[2]=d=>i.value=d)},{default:u(()=>[(f(!0),_(k,null,P(a(L),d=>(f(),y(a(ce),{key:d.name,title:d.name},{default:u(()=>[l(a(ue),{border:!1,clickable:""},{default:u(()=>[l(a(R),{icon:"success",text:"\u4F7F\u7528",onClick:w=>o.value=d.name},null,8,["onClick"]),(f(!0),_(k,null,P(a(ye).filter(w=>w.category===d.name),w=>(f(),y(a(R),{icon:"photo-o",text:w.name},null,8,["text"]))),256))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1})]),_:1}),m("div",He,[l(K,{round:"",block:"",type:"success",onClick:h},{default:u(()=>[Ie]),_:1})]),l(Ve),l(a(re),{modelValue:s.value,"onUpdate:modelValue":p[3]||(p[3]=d=>s.value=d),"extra-key":".",show:r.value,maxlength:10,onBlur:p[4]||(p[4]=d=>r.value=!1)},null,8,["modelValue","show"])])}}}),C=de({history:pe(),routes:[{path:"/",name:"Home",component:Ue},{path:"/login",name:"Login",component:()=>U(()=>import("./index.981e10bb.js"),["assets/index.981e10bb.js","assets/index.7ca3d404.css","assets/vendor.a347c1fa.js","assets/vendor.ca08612c.css"]),meta:{title:"\u767B\u9646"}}],scrollBehavior(e,t,n){return n||{top:0}}});C.beforeEach(async e=>e.name==="Login"||await Re()?!0:{name:"Login"});C.beforeEach(e=>{e.meta.title?document.title=e.meta.title+" - "+x:document.title=x});ge({});const G=fe();G.use(me);he(ke).use(O).use(A).use(ve).use(C).use(G).mount("#app");{document.addEventListener("gesturestart",function(t){t.preventDefault()}),document.addEventListener("dblclick",function(t){t.preventDefault()}),document.addEventListener("touchstart",function(t){t.touches.length>1&&t.preventDefault()});let e=0;document.addEventListener("touchend",function(t){const n=new Date().getTime();n-e<=300&&t.preventDefault(),e=n},!1)}export{ze as l,x as n};
