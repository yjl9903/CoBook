import{v as G,d as D,r as _,c as K,a as h,u as s,b as y,w as u,N as M,e as q,f as l,P as J,F as k,g as Q,p as X,h as b,o as m,I as R,i as v,t as g,j as Y,k as Z,l as P,m as ee,T as S,n as B,L as te,C as j,q as ne,s as re,x as oe,y as ae,z as O,A as se,G as ie,B as T,D as le,E as ue,H as ce,J as de,K as pe,M as fe,O as me}from"./vendor.7d3f8dc9.js";const ve=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};ve();function _e(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:r,onRegisterError:a}=e;let o;const c=async(d=!0)=>{};return"serviceWorker"in navigator&&(o=new G("/sw.js",{scope:"/",type:"classic"}),o.addEventListener("activated",d=>{d.isUpdate?window.location.reload():i==null||i()}),o.register({immediate:t}).then(d=>{r==null||r(d)}).catch(d=>{a==null||a(d)})),c}const x="Coin Book",I="https://cobook-worker.yjl9903.workers.dev",he=[{name:"Breakfast",icon:"/img/breakfast.svg",category:"Food",tags:["Food","Breakfast"],amount:10},{name:"Lunch",icon:"/img/lunch.svg",category:"Food",tags:["Food","Lunch"],amount:10},{name:"Dinner",icon:"/img/dinner.svg",category:"Food",tags:["Food","Dinner"],amount:10},{name:"Tea",icon:"/img/tea.svg",category:"Drink",tags:["Drink"]}],F=[{name:"Food",color:"#F2F3F5"},{name:"Drink",color:"#F2F3F5"}],H="EnterHome";const ge={style:{"font-weight":"bold"}},ye=D({setup(e){const t=Q(),n=_(!1);X(H,n);const i=K(()=>t.name==="Login"),r=_(!1);return(a,o)=>{const c=b("router-view");return m(),h(k,null,[!s(i)&&n.value?(m(),y(s(M),{key:0,fixed:"",placeholder:""},{left:u(()=>[l(s(R),{name:"ellipsis",color:"black",onClick:o[0]||(o[0]=d=>r.value=!0)})]),title:u(()=>[v("span",ge,g(s(x)),1)]),right:u(()=>[l(s(R),{name:"setting-o",color:"black"})]),_:1})):q("",!0),l(s(J),{show:r.value,"onUpdate:show":o[1]||(o[1]=d=>r.value=d),position:"left",style:{height:"100%",width:"60%"}},null,8,["show"]),l(c)],64)}}}),we="modulepreload",V={},ke="/",A=function(t,n){return!n||n.length===0?t():Promise.all(n.map(i=>{if(i=`${ke}${i}`,i in V)return;V[i]=!0;const r=i.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${a}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":we,r||(o.as="script",o.crossOrigin=""),o.href=i,document.head.appendChild(o),r)return new Promise((c,d)=>{o.addEventListener("load",c),o.addEventListener("error",d)})})).then(()=>t())};var be=Object.defineProperty,Ee=Object.defineProperties,Le=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,Fe=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,N=(e,t,n)=>t in e?be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Oe=(e,t)=>{for(var n in t||(t={}))Fe.call(t,n)&&N(e,n,t[n]);if($)for(var n of $(t))Pe.call(t,n)&&N(e,n,t[n]);return e},xe=(e,t)=>Ee(e,Le(t)),E=class{constructor(e,t,n){this.errorHandler=[],this.fingerprint=n,this.api=Y.create({baseURL:e,headers:{Authorization:t}})}async validate(){try{return await this.api.get("/"),!0}catch{return!1}}async create(e){const{data:t}=await this.api.post("/account",xe(Oe({},e),{fingerprint:this.fingerprint,timestamp:new Date().getTime()}));if(E.isResponseError(t))throw await this.handleError(t),t;return t}async list(){const{data:e}=await this.api.get("/accounts");if(E.isResponseError(e))throw await this.handleError(e),e;return e.accounts}static isResponseError(e){return!e||e.status==="ERROR"}onError(e){this.errorHandler.push(e)}async handleError(e){await Promise.all(this.errorHandler.map(t=>t(e)))}};async function U(){return await(await(await A(()=>import("./fp.esm.27f96b96.js"),[])).load()).get()}const De=U();async function Be(){try{return await De}catch{return await U()}}const L=Z("authorization",{state:()=>({fingerprint:"",pass:""}),getters:{client:e=>new E(I,e.pass,e.fingerprint)},persist:!0});async function Ce(){const e=L();return e.pass!==""&&e.fingerprint!==""&&await e.client.validate()}async function Ue(e){const t=L();return t.fingerprint=(await Be()).visitorId,await new E(I,e,t.fingerprint).validate()?(t.pass=e,!0):!1}const Re={flex:"",justify:"between",items:"center"},Te={"inline-block":"",mr:"2",text:"gray-400"},Ve=D({setup(e){const t=L(),n=_([]);return t.client.list().then(i=>{n.value.push(...i.reverse())}),(i,r)=>{const a=b("van-cell"),o=b("van-cell-group");return m(),y(o,{inset:""},{default:u(()=>[l(s(te),null,{default:u(()=>[(m(!0),h(k,null,P(n.value,c=>(m(),y(a,{key:c.timestamp},{default:u(()=>[v("div",Re,[v("span",null,[v("span",Te,g(s(ee)(new Date(c.timestamp),"yyyy-MM-dd hh:mm")),1),l(s(S),null,{default:u(()=>[B(g(c.category),1)]),_:2},1024)]),v("span",null,"\uFFE5 "+g(c.amount),1)])]),_:2},1024))),128))]),_:1})]),_:1})}}});const $e={id:"home",h:"full",pt:"4"},Ne={flex:"",justify:"between"},Se=v("span",null,"\u5206\u7C7B",-1),je={style:{margin:"16px"}},Ie=B("\u8BB0\u5F55"),He=D({setup(e){const t=re(H);t.value=!0;const n=L(),i=_(),r=_(!1),a=_(""),o=_(F.length>0?F[0].name:""),c=async()=>{await n.client.create({amount:+a.value,category:o.value,tags:[],description:""})};return(d,f)=>{const z=b("van-button");return m(),h("div",$e,[l(s(j),{inset:""},{default:u(()=>[l(s(oe),{modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=p=>a.value=p),label:"\u91D1\u989D",readonly:"",clickable:"",placeholder:"0",onTouchstart:f[1]||(f[1]=ae(p=>r.value=!0,["stop"])),"input-align":"right"},null,8,["modelValue"]),l(s(O),null,{default:u(()=>[v("div",Ne,[Se,l(s(S),null,{default:u(()=>[B(g(o.value),1)]),_:1})])]),_:1}),l(s(O),null,{default:u(()=>[l(s(se),{active:i.value,"onUpdate:active":f[2]||(f[2]=p=>i.value=p)},{default:u(()=>[(m(!0),h(k,null,P(s(F),p=>(m(),y(s(le),{key:p.name,title:p.name},{default:u(()=>[l(s(ie),{border:!1,clickable:""},{default:u(()=>[l(s(T),{icon:"success",text:"\u4F7F\u7528",onClick:w=>o.value=p.name},null,8,["onClick"]),(m(!0),h(k,null,P(s(he).filter(w=>w.category===p.name),w=>(m(),y(s(T),{icon:"photo-o",text:w.name},null,8,["text"]))),256))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1})]),_:1}),v("div",je,[l(z,{round:"",block:"",type:"success",onClick:c},{default:u(()=>[Ie]),_:1})]),l(Ve),l(s(ne),{modelValue:a.value,"onUpdate:modelValue":f[3]||(f[3]=p=>a.value=p),"extra-key":".",show:r.value,maxlength:10,onBlur:f[4]||(f[4]=p=>r.value=!1)},null,8,["modelValue","show"])])}}}),C=ue({history:ce(),routes:[{path:"/",name:"Home",component:He},{path:"/login",name:"Login",component:()=>A(()=>import("./index.4f562fcc.js"),["assets/index.4f562fcc.js","assets/index.728f1658.css","assets/vendor.7d3f8dc9.js","assets/vendor.8ed0b1dc.css"]),meta:{title:"\u767B\u9646"}}],scrollBehavior(e,t,n){return n||{top:0}}});C.beforeEach(async e=>e.name==="Login"||await Ce()?!0:{name:"Login"});C.beforeEach(e=>{e.meta.title?document.title=e.meta.title+" - "+x:document.title=x});_e({});const W=de();W.use(pe);fe(ye).use(O).use(j).use(me).use(C).use(W).mount("#app");{document.addEventListener("gesturestart",function(t){t.preventDefault()}),document.addEventListener("dblclick",function(t){t.preventDefault()}),document.addEventListener("touchstart",function(t){t.touches.length>1&&t.preventDefault()});let e=0;document.addEventListener("touchend",function(t){const n=new Date().getTime();n-e<=300&&t.preventDefault(),e=n},!1)}export{Ue as l,x as n};
