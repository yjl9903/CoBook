var _e=Object.defineProperty;var W=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var G=(t,e,n)=>e in t?_e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,q=(t,e)=>{for(var n in e||(e={}))ge.call(e,n)&&G(t,n,e[n]);if(W)for(var n of W(e))he.call(e,n)&&G(t,n,e[n]);return t};import{v as ye,a as we,d as U,b as C,u as be,c as ke,r as g,e as N,f as h,o as f,g as x,h as l,i as b,w as i,j as d,t as E,k as u,I as xe,P as Ee,N as $e,l as te,F as $,p as Ce,m as Fe,n as De,q as L,C as Se,s as Ve,x as ne,y as Le,A as H,z as R,B as Be,D as T,E as oe,G as B,H as A,L as Pe,J as Oe,K as j,T as Re,M as ae,O as Te,Q as Ae,R as K,S as je,U as Ie,V as Ue,W as Ne,X as se,Y as He,Z as Me,_ as ze,$ as We,a0 as Ge}from"./vendor.35ca05ff.js";const qe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};qe();function Ke(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:a,onRegistered:o,onRegisterError:s}=t;let c;const _=async(r=!0)=>{};return"serviceWorker"in navigator&&(c=new ye("/sw.js",{scope:"/",type:"classic"}),c.addEventListener("activated",r=>{r.isUpdate?window.location.reload():a==null||a()}),c.register({immediate:e}).then(r=>{o==null||o(r)}).catch(r=>{s==null||s(r)})),_}const I="Coin Book",re="https://cobook-worker.yjl9903.workers.dev",Je=[{name:"Breakfast",icon:"/img/breakfast.svg",category:"Food",tags:["Breakfast"],amount:10},{name:"Lunch",icon:"/img/lunch.svg",category:"Food",tags:["Lunch"],amount:10},{name:"Dinner",icon:"/img/dinner.svg",category:"Food",tags:["Dinner"],amount:10},{name:"Tea",icon:"/img/tea.svg",category:"Drink",tags:["Tea"]}],le=[{name:"Breakfast",color:"#fde047"},{name:"Lunch",color:"#c4b5fd"},{name:"Dinner",color:"#cbd5e1"},{name:"Tea",color:"#bef264"}],P=[{name:"Food",color:"#93c5fd"},{name:"Drink",color:"#6ee7b7"}];var Qe=Object.defineProperty,Xe=Object.defineProperties,Ye=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable,Q=(t,e,n)=>e in t?Qe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X=(t,e)=>{for(var n in e||(e={}))Ze.call(e,n)&&Q(t,n,e[n]);if(J)for(var n of J(e))et.call(e,n)&&Q(t,n,e[n]);return t},Y=(t,e)=>Xe(t,Ye(e)),S=class{constructor(t,e,n){this.errorHandler=[],this.fingerprint=n,this.api=we.create({baseURL:t,headers:{Authorization:e}})}async validate(){try{return await this.api.get("/"),!0}catch{return!1}}async create(t){const{data:e}=await this.api.post("/account",Y(X({},t),{timestamp:new Date().toISOString(),fingerprint:this.fingerprint}));if(S.isResponseError(e))throw await this.handleError(e),e;return e}async update(t,e){const{data:n}=await this.api.put(`/account/${t}`,Y(X({},e),{fingerprint:this.fingerprint}));if(S.isResponseError(n))throw await this.handleError(n),n;return n}async delete(t){const{data:e}=await this.api.delete(`/account/${t}`);return!S.isResponseError(e)}async list(){const{data:t}=await this.api.get("/accounts");if(S.isResponseError(t))throw await this.handleError(t),t;return t.accounts}static isResponseError(t){return!t||t.status==="ERROR"}onError(t){this.errorHandler.push(t)}async handleError(t){await Promise.all(this.errorHandler.map(e=>e(t)))}};const tt="modulepreload",Z={},nt="/",O=function(e,n){return!n||n.length===0?e():Promise.all(n.map(a=>{if(a=`${nt}${a}`,a in Z)return;Z[a]=!0;const o=a.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${s}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":tt,o||(c.as="script",c.crossOrigin=""),c.href=a,document.head.appendChild(c),o)return new Promise((_,r)=>{c.addEventListener("load",_),c.addEventListener("error",r)})})).then(()=>e())};async function ue(){return await(await(await O(()=>import("./fp.esm.27f96b96.js"),[])).load()).get()}const ot=ue();async function at(){try{return await ot}catch{return await ue()}}const V=U("authorization",{state:()=>({fingerprint:"",pass:""}),getters:{client:t=>new S(re,t.pass,t.fingerprint)},persist:!0}),ie=U("authorization/valid",{state:()=>({ok:!1})});async function ce(){const t=ie();if(t.ok)return!0;const e=V(),n=e.pass!==""&&e.fingerprint!==""&&await e.client.validate();return t.ok=n,n}async function Ut(t){const e=ie(),n=V();return n.fingerprint=(await at()).visitorId,await new S(re,t,n.fingerprint).validate()?(e.ok=!0,n.pass=t,!0):!1}const de="EnterHome";const st={style:{"font-weight":"bold"}},rt=C({setup(t){const e=be(),n=ke(),a=g(!1);Ce(de,a),ce().then(r=>a.value=r);const o=N(()=>e.name==="Login"),s=g(!1),c=[{text:"\u8BB0\u5F55",icon:"home-o"},{text:"\u6240\u6709",icon:"orders-o"},{text:"\u5173\u4E8E",icon:"info-o"}],_=r=>{r.text===c[0].text?n.push({name:"Home"}):r.text===c[1].text?n.push({name:"Account"}):r.text===c[2].text&&n.push({name:"About"})};return(r,m)=>{const k=h("router-view");return f(),x($,null,[!l(o)&&a.value?(f(),b(l($e),{key:0,fixed:"",placeholder:""},{title:i(()=>[d("span",st,E(l(I)),1)]),right:i(()=>[u(l(Ee),{show:s.value,"onUpdate:show":m[0]||(m[0]=F=>s.value=F),actions:c,onSelect:_,placement:"bottom-end","show-arrow":!1,offset:[8,12]},{reference:i(()=>[u(l(xe),{name:"ellipsis",color:"black",mr:"1"})]),_:1},8,["show"])]),_:1})):te("",!0),u(k,{id:"main-view",h:"full"})],64)}}});const M=U("account",{state(){return{accounts:[]}},actions:{async init(){const e=await V().client.list();this.accounts=e},async push(t){const n=await V().client.create({amount:t.amount,category:t.category,tags:t.tags,description:t.description});this.accounts.push(n)},async update(t,e){const a=await V().client.update(t,e),o=this.accounts.findIndex(s=>s.timestamp===t);return o!==-1&&(this.accounts.splice(o,1),this.accounts.push(a),this.accounts.sort((s,c)=>s.timestamp.localeCompare(c.timestamp))),a},async delete(t){const n=await V().client.delete(t.timestamp);if(n){const a=this.accounts.findIndex(o=>o.timestamp===t.timestamp);return a!==-1&&this.accounts.splice(a,1),n}else return!1}},persist:!0}),lt={flex:"",justify:"between"},ut=d("span",null,"\u6807\u7B7E",-1),it={px:"4",pb:"8"},ct={flex:"",items:"center"},pe=C({props:{modelValue:null},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,{modelValue:a}=Fe(n),o=g(!1),s=g([]);De(()=>{s.value=[]});const c=_=>{s.value[_].toggle()};return(_,r)=>{const m=h("Tag"),k=h("van-cell"),F=h("van-cell-group");return f(),x($,null,[u(k,{clickable:"",onClick:r[0]||(r[0]=p=>o.value=!0)},{default:i(()=>[d("div",lt,[ut,d("span",null,[(f(!0),x($,null,L(l(a),p=>(f(),b(m,{ml:"1",tag:p},null,8,["tag"]))),256))])])]),_:1}),u(l(H),{show:o.value,"onUpdate:show":r[3]||(r[3]=p=>o.value=p),title:"\u6807\u7B7E",duration:.2,"overlay-style":{background:"rgba(0, 0, 0, .1)"}},{default:i(()=>[d("div",it,[u(l(Se),{"model-value":l(a),"onUpdate:modelValue":r[2]||(r[2]=p=>e("update:modelValue",p))},{default:i(()=>[u(F,null,{default:i(()=>[(f(!0),x($,null,L(l(le),(p,v)=>(f(),b(k,{clickable:"",key:p.name,onClick:w=>c(v)},{"right-icon":i(()=>[u(l(Ve),{name:p.name,ref_for:!0,ref:w=>s.value[v]=w,onClick:r[1]||(r[1]=ne(()=>{},["stop"])),shape:"square"},null,8,["name"])]),default:i(()=>[d("div",ct,[d("span",{h:"4",w:"4",mr:"2","inline-block":"",rounded:"full",style:Le({background:p.color})},null,4),d("span",null,E(p.name),1)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["model-value"])])]),_:1},8,["show","duration","overlay-style"])],64)}}}),dt={px:"4",pb:"8"},ee=C({props:{title:null},setup(t){const e=g(!1);return(n,a)=>{const o=h("van-cell");return f(),x($,null,[u(o,{clickable:"",onClick:a[0]||(a[0]=s=>e.value=!0)},{default:i(()=>[R(n.$slots,"cell")]),_:3}),u(l(H),{show:e.value,"onUpdate:show":a[1]||(a[1]=s=>e.value=s),title:t.title,duration:.2,"overlay-style":{background:"rgba(0, 0, 0, .1)"}},{default:i(()=>[d("div",dt,[R(n.$slots,"default")])]),_:3},8,["show","title","duration","overlay-style"])],64)}}}),pt={px:"4",pb:"8"},mt={flex:"",justify:"between"},ft=d("span",null,"\u91D1\u989D",-1),vt={flex:"",justify:"between"},_t=d("span",null,"\u5206\u7C7B",-1),gt={flex:"",justify:"between"},ht=d("span",null,"\u65F6\u95F4",-1),yt={mt:"4",text:"right"},wt=B("\u4FDD\u5B58"),bt=B("\u5220\u9664"),kt=C({props:{account:null},emits:["close"],setup(t,{emit:e}){const n=t,a=g(n.account),o=g(!1);Be(()=>n.account,r=>{r&&(a.value=q({},r),o.value=!0)});const s=M(),c=async()=>{a.value&&(await s.update(n.account.timestamp,a.value),o.value=!1,A({message:"\u66F4\u65B0\u6210\u529F",type:"success"}))},_=async()=>{a.value&&(await s.delete(a.value),o.value=!1,A({message:"\u5220\u9664\u6210\u529F",type:"success"}))};return(r,m)=>{const k=h("Category"),F=h("van-cell"),p=h("van-cell-group"),v=h("van-button");return f(),b(l(H),{show:o.value,"onUpdate:show":m[4]||(m[4]=w=>o.value=w),title:t.account&&l(T)(new Date(t.account.timestamp),"yyyy-MM-dd hh:mm"),duration:.2,"overlay-style":{background:"rgba(0, 0, 0, .1)"},onClose:m[5]||(m[5]=w=>e("close"))},{default:i(()=>[d("div",pt,[a.value?(f(),b(p,{key:0},{default:i(()=>[u(ee,{title:"\u91D1\u989D"},{cell:i(()=>[d("div",mt,[ft,d("span",null,"\uFFE5 "+E(a.value.amount),1)])]),_:1}),u(F,null,{default:i(()=>[d("div",vt,[_t,u(k,{category:a.value.category},null,8,["category"])])]),_:1}),u(pe,{modelValue:a.value.tags,"onUpdate:modelValue":m[0]||(m[0]=w=>a.value.tags=w)},null,8,["modelValue"]),u(ee,{title:"\u65F6\u95F4"},{cell:i(()=>[d("div",gt,[ht,d("span",null,E(l(T)(new Date(a.value.timestamp),"yyyy-MM-dd hh:mm:ss")),1)])]),_:1}),u(l(oe),{modelValue:a.value.description,"onUpdate:modelValue":m[1]||(m[1]=w=>a.value.description=w),rows:"2",autosize:"",label:"\u5907\u6CE8",type:"textarea",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})):te("",!0),d("div",yt,[u(v,{round:"",icon:"guide-o",type:"success",mr:"4",onClick:m[2]||(m[2]=w=>c())},{default:i(()=>[wt]),_:1}),u(v,{round:"",icon:"delete",type:"danger",onClick:m[3]||(m[3]=w=>_())},{default:i(()=>[bt]),_:1})])])]),_:1},8,["show","title","duration","overlay-style"])}}});const xt={flex:"",justify:"between",items:"center"},Et={"inline-block":"",mr:"2",text:"gray-400"},$t=C({setup(t){const e=M();e.init();const n=g();return(a,o)=>{const s=h("Category"),c=h("van-cell"),_=h("van-cell-group");return f(),b(_,{inset:""},{default:i(()=>[u(l(Pe),null,{default:i(()=>[(f(!0),x($,null,L(l(e).accounts.slice().reverse(),r=>(f(),b(c,{key:r.timestamp,clickable:"",onClick:m=>n.value=r},{default:i(()=>[d("div",xt,[d("span",null,[d("span",Et,E(l(T)(new Date(r.timestamp),"yyyy-MM-dd hh:mm")),1),u(s,{category:r.category},null,8,["category"])]),d("span",null,"\uFFE5 "+E(r.amount),1)])]),_:2},1032,["onClick"]))),128))]),_:1}),u(kt,{account:n.value,onClose:o[0]||(o[0]=r=>n.value=void 0)},null,8,["account"])]),_:1})}}});const Ct={id:"home",h:"full",pt:"4"},Ft={flex:"",justify:"between"},Dt=d("span",null,"\u5206\u7C7B",-1),St={flex:"","flex-col":"",items:"center",justify:"center"},Vt={h:"full",w:"full"},Lt={class:"van-grid-item__text",mt:"2"},Bt={style:{margin:"16px"}},Pt=B("\u8BB0\u5F55"),Ot=C({setup(t){Oe(de).value=!0;const e=M(),n=g(),a=g(!1),o=g(),s=g(""),c=p=>(s.value="",/\d+\.\d\d\d+$/.test(p)?Number.parseFloat(p).toFixed(2):p),_=g(P.length>0?P[0].name:""),r=g([]),m=g(""),k=p=>{_.value=p.category,p.amount?o.value=String(p.amount):o.value="",p.tags?r.value=p.tags:r.value=[],p.description,m.value=""},F=async()=>{if(!o.value||o.value===""){s.value="\u8BF7\u8F93\u5165\u91D1\u989D";return}await e.push({amount:+o.value,category:_.value,tags:r.value,description:m.value}),A({message:"\u8BB0\u5F55\u6210\u529F",type:"success"}),o.value="",r.value=[],m.value=""};return(p,v)=>{const w=h("Category"),fe=h("van-image"),ve=h("van-button");return f(),x("div",Ct,[u(l(ae),{inset:""},{default:i(()=>[u(l(oe),{modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=y=>o.value=y),label:"\u91D1\u989D",readonly:"",clickable:"",clearable:"",formatter:c,maxlength:10,"error-message":s.value,"error-message-align":"right",onTouchstart:v[1]||(v[1]=ne(y=>a.value=!0,["stop"])),"input-align":"right"},null,8,["modelValue","error-message"]),u(l(j),null,{default:i(()=>[d("div",Ft,[Dt,u(w,{category:_.value},null,8,["category"])])]),_:1}),u(pe,{modelValue:r.value,"onUpdate:modelValue":v[2]||(v[2]=y=>r.value=y)},null,8,["modelValue"]),u(l(j),null,{default:i(()=>[u(l(Re),{active:n.value,"onUpdate:active":v[3]||(v[3]=y=>n.value=y)},{default:i(()=>[(f(!0),x($,null,L(l(P),y=>(f(),b(l(Ie),{key:y.name,title:y.name},{default:i(()=>[u(l(Ae),{border:!1,clickable:""},{default:i(()=>[u(l(K),{icon:"success",text:"\u4F7F\u7528",onClick:D=>k({category:y.name})},null,8,["onClick"]),(f(!0),x($,null,L(l(Je).filter(D=>D.category===y.name),D=>(f(),b(l(K),{onClick:At=>k(D)},{default:i(()=>[d("div",St,[u(fe,{src:D.icon,height:"50%",width:"50%"},{loading:i(()=>[d("div",Vt,[u(l(je),{type:"spinner",size:"20"})])]),_:2},1032,["src"]),d("span",Lt,E(D.name),1)])]),_:2},1032,["onClick"]))),256))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),_:1})]),_:1}),d("div",Bt,[u(ve,{round:"",block:"",type:"success",onClick:F},{default:i(()=>[Pt]),_:1})]),u($t),u(l(Te),{modelValue:o.value,"onUpdate:modelValue":v[4]||(v[4]=y=>o.value=y),"extra-key":".",show:a.value,maxlength:10,onBlur:v[5]||(v[5]=y=>a.value=!1)},null,8,["modelValue","show"])])}}}),z=Ue({history:Ne(),routes:[{path:"/",name:"Home",component:Ot},{path:"/account",name:"Account",component:()=>O(()=>import("./index.1b6ce9d7.js"),["assets/index.1b6ce9d7.js","assets/index.97d966c7.css","assets/vendor.35ca05ff.js","assets/vendor.b848d3cd.css"])},{path:"/login",name:"Login",component:()=>O(()=>import("./Login.4d681175.js"),["assets/Login.4d681175.js","assets/Login.79953f6d.css","assets/vendor.35ca05ff.js","assets/vendor.b848d3cd.css"]),meta:{title:"\u767B\u9646"}},{path:"/about",name:"About",component:()=>O(()=>import("./About.12857bd4.js"),["assets/About.12857bd4.js","assets/About.393076f1.css","assets/vendor.35ca05ff.js","assets/vendor.b848d3cd.css"]),meta:{title:"\u5173\u4E8E"}}],scrollBehavior(t,e,n){return n||{top:0}}});z.beforeEach(async t=>t.name==="Login"||await ce()?!0:{name:"Login"});z.beforeEach(t=>{t.meta.title?document.title=t.meta.title+" - "+I:document.title=I});const Rt=C({props:{tag:null},setup(t){const e=t,n=N(()=>{var a,o;return typeof e.tag=="string"?{name:e.tag,color:(o=(a=le.find(s=>s.name===e.tag))==null?void 0:a.color)!=null?o:"#F2F3F5"}:e.tag});return(a,o)=>(f(),b(l(se),{color:l(n).color},{default:i(()=>[R(a.$slots,"default",{},()=>[B(E(l(n).name),1)])]),_:3},8,["color"]))}}),Tt=C({props:{category:null},setup(t){const e=t,n=N(()=>{var a,o;return typeof e.category=="string"?{name:e.category,color:(o=(a=P.find(s=>s.name===e.category))==null?void 0:a.color)!=null?o:"#F2F3F5"}:e.category});return(a,o)=>(f(),b(l(se),{color:l(n).color},{default:i(()=>[R(a.$slots,"default",{},()=>[B(E(l(n).name),1)])]),_:3},8,["color"]))}});Ke({});const me=He();me.use(Me);ze(rt).component("Category",Tt).component("Tag",Rt).use(j).use(ae).use(We).use(Ge).use(z).use(me).mount("#app");{document.addEventListener("gesturestart",function(e){e.preventDefault()}),document.addEventListener("dblclick",function(e){e.preventDefault()}),document.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()});let t=0;document.addEventListener("touchend",function(e){const n=new Date().getTime();n-t<=300&&e.preventDefault(),t=n},!1)}export{$t as _,at as f,Ut as l,I as n};
